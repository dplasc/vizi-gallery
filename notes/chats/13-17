Evo **STRUCTURED SUMMARY / HANDOFF** za **ovaj chat**, točno po traženom formatu, bez novih ideja i bez scope creepa.

---

## 1. Chat broj

**Chat #15**

## 2. Naslov chata

**Vizi.hr — FAZA 13–17: Public profile fields (headline, location, website) + avatar upload + website display normalization**

## 3. Faza projekta

* **FAZA 13 — Profile content: headline**
* **FAZA 14 — Profile content: location**
* **FAZA 15 — Profile content: website (URL + normalization)**
* **FAZA 16 — Avatar upload (Supabase Storage)**
* **FAZA 17 — Website display normalization (UX polish)**

## 4. Što smo konkretno napravili / zaključili

* Dodan **headline** u `profiles` (DB, UI, Server Action, public fetch i prikaz)
* Dodan **location** u `profiles` (DB, UI, Server Action, public fetch i prikaz)
* Dodan **website** u `profiles`:

  * server-side normalizacija (dodaje `https://` ako nedostaje)
  * siguran public link (`target="_blank"`, `rel="noreferrer noopener"`)
* Implementiran **avatar upload**:

  * Supabase Storage bucket `avatars` (public)
  * Storage RLS policyji (read public, write/update/delete samo vlastiti folder)
  * Upload slike (jpg/png/webp, max 2MB)
  * Spremanje `avatar_url` u `profiles`
  * Prikaz avatara na public profilu
* Implementirana **normalizacija prikaza website linka**:

  * uklanja `https://` / `http://` i trailing `/`
  * `href` ostaje puni URL
* Sve promjene:

  * non-breaking
  * TypeScript strict prolazi
  * bez promjena na auth i RLS za `profiles`
* Sve funkcionalnosti **potvrđene u Supabase (proof testovi)**

## 5. Što je IZRIČITO odlučeno / zaključano

* `profiles` je **jedini izvor istine** za public profile podatke
* Public profil koristi **isključivo server-side fetch** s `origin` iz `next/headers`
* Storage bucket `avatars` je **public**, ali write operacije su strogo ograničene po `auth.uid()`
* Avatar path je **`${userId}/avatar.<ext>`** (overwrite dozvoljen)
* Website se **sprema kao puni URL**, ali se **prikazuje normalizirano**
* Radimo **1 polje = 1 faza**, bez scope creepa

## 6. Otvorene stavke

* Nema otvorenih stavki iz FAZA 13–17

## 7. Sljedeći dogovoreni korak (samo jedan)

* **FAZA 18 — odabir smjera** (npr. prvi social link *ili* UX polish), još **nije započeta**

## 8. Napomena za nastavak u novom chatu

FAZE 13–17 su stabilne i zatvorene. U novom chatu se može sigurno krenuti u FAZU 18 bez diranja postojećeg profila, autha ili storage logike.

---

Kad otvoriš novi chat, samo napiši:
**“Nastavljamo Vizi.hr — FAZA 18”**
i ja preuzimam dalje.
